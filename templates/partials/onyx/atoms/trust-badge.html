{#
  Onyx TRUST BADGE COMPONENT (MACRO)
  Security and trust indicator badges for Tor, Escrow, Non-Custodial

  Usage:
    {% import "partials/onyx/atoms/trust-badge.html" as trust %}
    {{ trust::badge(type="tor") }}
    {{ trust::badge(type="escrow") }}
    {{ trust::badge(type="noncustodial") }}
    {{ trust::badge(type="verified") }}

  Parameters:
    - type (required): tor|escrow|noncustodial|verified
    - class (optional): Additional CSS classes
    - compact (optional): Show icon-only version for tight spaces (default: false)

  Group Usage:
    {{ trust::badges(types=["tor", "escrow", "noncustodial"]) }}

  Examples:
    Single badge:
      {{ trust::badge(type="tor") }}

    Compact badge (icon only):
      {{ trust::badge(type="escrow", compact=true) }}

    Badge group:
      {{ trust::badges(types=["tor", "escrow", "noncustodial"]) }}
#}

{% macro badge(type, class="", compact=false) %}
  {# Badge configuration using conditionals (Tera doesn't support object literals) #}
  {%- if type == "tor" -%}
    {%- set label = "TOR-ONLY" -%}
    {%- set icon = "shield" -%}
    {%- set title = "This marketplace is accessible only via Tor for maximum privacy" -%}
  {%- elif type == "escrow" -%}
    {%- set label = "ESCROW PROTECTED" -%}
    {%- set icon = "lock" -%}
    {%- set title = "Your payment is held in escrow until you confirm delivery" -%}
  {%- elif type == "noncustodial" -%}
    {%- set label = "NON-CUSTODIAL" -%}
    {%- set icon = "key" -%}
    {%- set title = "Your private keys never leave your browser - you control your funds" -%}
  {%- elif type == "verified" -%}
    {%- set label = "VERIFIED" -%}
    {%- set icon = "check-circle" -%}
    {%- set title = "This vendor has been verified by the marketplace" -%}
  {%- else -%}
    {# Default to escrow #}
    {%- set label = "ESCROW PROTECTED" -%}
    {%- set icon = "lock" -%}
    {%- set title = "Your payment is held in escrow until you confirm delivery" -%}
  {%- endif -%}

  {%- set css_classes = "trust-badge trust-badge--" ~ type -%}

  {%- if compact -%}
    {%- set css_classes = css_classes ~ " trust-badge--compact" -%}
  {%- endif -%}

  {%- if class -%}
    {%- set css_classes = css_classes ~ " " ~ class -%}
  {%- endif -%}

  <span class="{{ css_classes }}" title="{{ title }}" aria-label="{{ title }}">
    {%- if icon == "shield" -%}
    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
      <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
    </svg>
    {%- elif icon == "lock" -%}
    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
      <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
      <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
    </svg>
    {%- elif icon == "key" -%}
    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
      <path d="m21 2-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0 3 3L22 7l-3-3m-3.5 3.5L19 4"></path>
    </svg>
    {%- elif icon == "check-circle" -%}
    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
      <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
      <polyline points="22 4 12 14.01 9 11.01"></polyline>
    </svg>
    {%- endif -%}
    {%- if not compact -%}
    <span>{{ label }}</span>
    {%- endif -%}
  </span>
{%- endmacro badge %}

{% macro badges(types, class="") %}
  {%- set css_classes = "trust-badges" -%}
  {%- if class -%}
    {%- set css_classes = css_classes ~ " " ~ class -%}
  {%- endif -%}

  <div class="{{ css_classes }}">
    {%- for type in types -%}
      {{ self::badge(type=type) }}
    {%- endfor -%}
  </div>
{%- endmacro badges %}

{% macro buyer_protection_box(class="") %}
  {#
    Buyer Protection Info Box
    Use on product detail pages to explain escrow protection

    Usage:
      {{ trust::buyer_protection_box() }}
  #}
  {%- set css_classes = "buyer-protection-box" -%}
  {%- if class -%}
    {%- set css_classes = css_classes ~ " " ~ class -%}
  {%- endif -%}

  <div class="{{ css_classes }}">
    <div class="buyer-protection-box__header">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="buyer-protection-box__icon" aria-hidden="true">
        <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
      </svg>
      <h4 class="buyer-protection-box__title">BUYER PROTECTION</h4>
    </div>
    <p class="buyer-protection-box__text">
      Your payment is held in escrow until you confirm delivery.
    </p>
    <details class="education-expandable">
      <summary>How does this work?</summary>
      <div class="education-expandable__content">
        <p>When you pay, your funds are locked in a secure contract between you, the seller, and a neutral arbiter.</p>
        <ul>
          <li>Neither party can access the funds alone</li>
          <li>You release payment after receiving your order</li>
          <li>If there's a problem, the arbiter helps resolve it</li>
        </ul>
      </div>
    </details>
  </div>
{%- endmacro buyer_protection_box %}
