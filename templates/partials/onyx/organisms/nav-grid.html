{# Onyx GRID HEADER - Structure wodniack avec séparations verticales #}

<header class="onyx-grid-header">

  {# ========== CARRÉ 1: LOGO ========== #}
  <div class="onyx-grid-box onyx-grid-logo">
    <a href="/" hx-boost="true">NX</a>
  </div>

  {# ========== RECTANGLE 2: TYPEWRITER ========== #}
  <div class="onyx-grid-box onyx-grid-typewriter">
    <div class="onyx-typewriter-content">
      <span id="onyx-simple-typewriter-text"></span>
      <span class="onyx-cursor">|</span>
    </div>
  </div>

  {# ========== RECTANGLE 3: NAVIGATION ========== #}
  <div class="onyx-grid-box onyx-grid-nav">
    <nav>
      <a href="/" hx-boost="true">HOME</a>
      <span class="sep">•</span>
      <a href="/listings#categories">CATEGORIES</a>
      <span class="sep">•</span>
      <a href="/listings" hx-boost="true">LISTINGS</a>
      <span class="sep">•</span>
      <a href="/vendors" hx-boost="true">VENDORS</a>
    </nav>
  </div>

  {# ========== CARRÉ 4: AUTH (divisé en 2) ========== #}
  <div class="onyx-grid-box onyx-grid-auth">

    {# Zone gauche: Login / User Menu #}
    <div class="onyx-auth-half">
      {% if logged_in %}
        <div class="onyx-user-menu-container">
          <button class="onyx-auth-icon onyx-user-menu-trigger" id="onyx-user-menu-trigger">
            {{ username | truncate(length=1, end="") | upper }}
          </button>
          <div class="onyx-user-dropdown" id="onyx-user-dropdown">
            <a href="/settings" class="onyx-dropdown-item" hx-boost="true">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="3"/><path d="M12 1v6m0 6v6m5.2-13.8l-4.2 4.2m0 0L8.8 19.2m0-8.4l4.2 4.2m0 0l4.2-4.2"/>
              </svg>
              <span>SETTINGS</span>
            </a>
            <a href="/orders" class="onyx-dropdown-item" hx-boost="true">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/>
              </svg>
              <span>ORDERS</span>
            </a>
            {% if role == "vendor" %}
            <a href="/listings/create" class="onyx-dropdown-item" hx-boost="true">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/>
              </svg>
              <span>NEW LISTING</span>
            </a>
            {% endif %}
            <div class="onyx-dropdown-divider"></div>
            <span class="onyx-dropdown-username">{{ username }}</span>
          </div>
        </div>
      {% else %}
        <a href="/login" class="onyx-auth-icon" hx-boost="true">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4M10 17l5-5-5-5M15 12H3"/>
          </svg>
        </a>
      {% endif %}
    </div>

    {# Zone droite: Logout #}
    <div class="onyx-auth-half">
      {% if logged_in %}
        <form action="/logout" method="POST" style="display: inline; margin: 0; width: 100%; height: 100%;">
          <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
          <button type="submit" class="onyx-auth-icon">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4M16 17l5-5-5-5M21 12H9"/>
            </svg>
          </button>
        </form>
      {% else %}
        <a href="/register" class="onyx-auth-icon" hx-boost="true">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2M12 7a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM20 8v6M23 11h-6"/>
          </svg>
        </a>
      {% endif %}
    </div>

  </div>

  {# ========== RECTANGLE 5: TOGGLE DARK/LIGHT (Brutalist Grunge Circle) ========== #}
  <div class="onyx-grid-box onyx-grid-toggle">
    <button class="brutalist-toggle-circle" id="onyx-toggle-dot" aria-label="Toggle theme">
      {# SVG texture applied via CSS background-image in brutalist-textures.css #}
    </button>
  </div>

</header>
